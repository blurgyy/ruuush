Imported from http://neerc.ifmo.ru/svn/projects/trunk/invoke/nt revision 2970
